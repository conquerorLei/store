### 1 密码修改

#### 1.1  持久层

##### 1.1.1  规划需要执行的SQL语句

根据用户的uid修改用password值。

```sql
update user set password = ?, modified_user = ?, modified_time = ? where uid = ?;
```

根据uid查询用户的数据。在修改密码之前，首先要保证当前这用户的数据存在，检测是否被标记为已经删除、检测输入的原始密码是否正确。

```sql
select * from t_user where uid = ?;
```

##### 1.1.2 设计接口和抽象方法

在UserMapper接口中添加方法

```java
	/**
     * @author LiXianLei
     * @describtion 修改密码
     * @return {@link Integer} 影响的行数
     * @param uid 用户编号
     * @param password 修改后的密码
     * @param modifiedUser 修改人
     * @param modifiedTime 修改时间
     * @time 2022/1/13 21:07
     **/
    Integer updatePassword(Integer uid, String password, String modifiedUser, Date modifiedTime);

    /**
     * @author LiXianLei
     * @describtion 根据用户id查询用户
     * @return {@link User} 用户
     * @param uid 用户编号
     * @time 2022/1/13 21:08
     **/
    User findByUid(Integer uid);
```

##### 1.1.3 编写映射

在UserMapper.xml文件中实现这个方法

```xml
<update id="updatePassword">
        update t_user
        set password = #{password},
            modified_user = #{modifiedUser},
            modified_time = #{modifiedTime}
        where uid = #{uid}
    </update>
    <select id="findByUid" resultMap="UserEntityMap">
        select * from t_user where uid = #{uid}
    </select>
```

##### 1.1.4 测试接口是否可用

```java
@Test
public void updatePassword(){
    String username = "tim";
    String password = "123";
    Integer rows = userMapper.updatePassword(username, password);
    if(rows == 1) System.out.println("密码已经修改");
    else System.out.println("发生未知错误");
}
```

![密码测试持久层提交记录](https://gitee.com/QingShanxl/pictures/raw/master/img//image-20220113205631830.png)

#### 1.2 业务层

##### 1.2.1 规划异常



#### 1.3 控制层

#### 1.4 前端页面

